<?xml version="1.0"?>
<config>
    <modules>
        <Magestore_Giftvoucher>
            <version>0.2.4</version>
        </Magestore_Giftvoucher>
    </modules>
    <frontend>
    	<secure_url>
    		<giftvoucher_checkout>/giftvoucher/checkout</giftvoucher_checkout>
    	</secure_url>
        <routers>
            <giftvoucher>
                <use>standard</use>
                <args>
                    <module>Magestore_Giftvoucher</module>
                    <frontName>giftvoucher</frontName>
                </args>
            </giftvoucher>
        </routers>
        <layout>
            <updates>
                <giftvoucher>
                    <file>giftvoucher.xml</file>
                </giftvoucher>
            </updates>
        </layout>
        <translate>
        	<modules>
        		<Magestore_Giftvoucher>
        			<files>
        				<default>Magestore_Giftvoucher.csv</default>
        			</files>
        		</Magestore_Giftvoucher>
        	</modules>
        </translate>
        <events>
        	<!--<controller_action_predispatch_checkout_cart_couponPost>
        		<observers>
        			<checkout_cart_couponPost_action>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>couponPostAction</method>
        			</checkout_cart_couponPost_action>
        		</observers>
        	</controller_action_predispatch_checkout_cart_couponPost>-->
        	<!--sales_quote_collect_totals_after>
				<observers>
        			<quote_collect_totals_after>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>collectTotalsAfter</method>
        			</quote_collect_totals_after>
        		</observers>
			</sales_quote_collect_totals_after-->
        	<sales_quote_collect_totals_before>
        		<observers>
        			<giftvoucher_collect_totals_before>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>collectTotalsBefore</method>
        			</giftvoucher_collect_totals_before>
        		</observers>
        	</sales_quote_collect_totals_before>
        	<sales_order_place_before>
        		<observers>
        			<giftvoucher_order_place_before>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>orderPlaceBefore</method>
        			</giftvoucher_order_place_before>
        		</observers>
        	</sales_order_place_before>
        	<sales_order_place_after>
        		<observers>
        			<giftvoucher_order_place_after>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>orderPlaceAfter</method>
        			</giftvoucher_order_place_after>
        		</observers>
        	</sales_order_place_after>
        	<!--<paypal_prepare_line_items>
        		<observers>
        			<giftvoucher_paypal_prepare_line_items>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>paypalPrepareItems</method>
        			</giftvoucher_paypal_prepare_line_items>
        		</observers>
        	</paypal_prepare_line_items>-->
        </events>
        <product>
        	<collection>
        		<attributes>
        			<gift_amount/>
        		</attributes>
        	</collection>
        </product>
    </frontend>
    <admin>
        <routers>
			<giftvoucheradmin>
				<use>admin</use>
				<args>
					<module>Magestore_Giftvoucher</module>
					<frontName>giftvoucheradmin</frontName>
				</args>
			</giftvoucheradmin>
        </routers>
    </admin>
    <adminhtml>
		<layout>
			<updates>
				<giftvoucher>
					<file>giftvoucher.xml</file>
				</giftvoucher>
			</updates>
		</layout>
        <translate>
        	<modules>
        		<Magestore_Giftvoucher>
        			<files>
        				<default>Magestore_Giftvoucher.csv</default>
        			</files>
        		</Magestore_Giftvoucher>
        	</modules>
        </translate>
        <sales>
        	<order>
        		<create>
        			<available_product_types>
        				<giftvoucher/>
        			</available_product_types>
        		</create>
        	</order>
        </sales>
    </adminhtml>
    <global>
        <models>
            <giftvoucher>
                <class>Magestore_Giftvoucher_Model</class>
                <resourceModel>giftvoucher_mysql4</resourceModel>
            </giftvoucher>
            <giftvoucher_mysql4>
                <class>Magestore_Giftvoucher_Model_Mysql4</class>
                <entities>
                    <giftvoucher>
                        <table>giftvoucher</table>
                    </giftvoucher>
                    <history>
                    	<table>giftvoucher_history</table>
                    </history>
                </entities>
            </giftvoucher_mysql4>
        </models>
        <resources>
            <giftvoucher_setup>
                <setup>
                    <module>Magestore_Giftvoucher</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </giftvoucher_setup>
            <giftvoucher_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </giftvoucher_write>
            <giftvoucher_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </giftvoucher_read>
        </resources>
        <blocks>
            <giftvoucher>
                <class>Magestore_Giftvoucher_Block</class>
            </giftvoucher>
        </blocks>
        <helpers>
            <giftvoucher>
                <class>Magestore_Giftvoucher_Helper</class>
            </giftvoucher>
        </helpers>
        <sales>
        	<quote>
        		<totals>
        			<giftvoucher>
        				<class>giftvoucher/total_quote_giftvoucher</class>
        				<!--renderer>giftvoucher/cart_total</renderer-->					
        				<after>wee,discount,tax,tax_subtotal,reward_point,grand_total</after>
					<before></before>
					
        			</giftvoucher>
        		</totals>
        	</quote>
        	<order_invoice>
        		<totals>
        			<giftvoucher>
        				<class>giftvoucher/total_order_invoice_giftvoucher</class>
        			</giftvoucher>
        		</totals>
        	</order_invoice>
        	<order_creditmemo>
        		<totals>
        			<giftvoucher>
        				<class>giftvoucher/total_order_creditmemo_giftvoucher</class>
        			</giftvoucher>
        		</totals>
        	</order_creditmemo>
        </sales>
    	<pdf>
    		<invoice>
    			<giftvoucher>giftvoucher/pdf_invoice_item</giftvoucher>
    		</invoice>
    		<shipment>
    			<giftvoucher>giftvoucher/pdf_shipment_item</giftvoucher>
    		</shipment>
    		<creditmemo>
    			<giftvoucher>giftvoucher/pdf_creditmemo_item</giftvoucher>
    		</creditmemo>
    		<totals>
    			<giftvoucher translate="title">
    				<title>Gift Voucher</title>
    				<source_field>gift_voucher_discount</source_field>
    				<model>giftvoucher/total_pdf_giftvoucher</model>
    				<font_size>7</font_size>
    				<display_zero>0</display_zero>
    				<sort_order>512</sort_order>
    			</giftvoucher>
    		</totals>
    	</pdf>
        <fieldsets>
        	<sales_convert_quote_address>
        		<base_gift_voucher_discount><to_order>*</to_order></base_gift_voucher_discount>
        		<gift_voucher_discount><to_order>*</to_order></gift_voucher_discount>
        		<gift_codes><to_order>*</to_order></gift_codes>
        		<codes_base_discount><to_order>*</to_order></codes_base_discount>
        		<codes_discount><to_order>*</to_order></codes_discount>
        	</sales_convert_quote_address>
        </fieldsets>
        <events>
            <controller_front_init_routers>
                <observers>
                    <giftvoucher>
                        <class>Magestore_Giftvoucher_Controller_Router</class>
                        <method>initControllerRouters</method>
                    </giftvoucher>
                </observers>
            </controller_front_init_routers>
       
        	<sales_order_load_after>
        		<observers>
        			<giftvoucher_order_load_after>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>orderLoadAfter</method>
        			</giftvoucher_order_load_after>
        		</observers>
        	</sales_order_load_after>
        	<sales_order_save_after>
        		<observers>
        			<giftvoucher_order_save_after>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>orderSaveAfter</method>
        			</giftvoucher_order_save_after>
        		</observers>
        	</sales_order_save_after>
        	<sales_order_creditmemo_save_after>
        		<observers>
        			<giftvoucher_creditmemo_save_after>
        				<type>singleton</type>
        				<class>giftvoucher/observer</class>
        				<method>creditmemoSaveAfter</method>
        			</giftvoucher_creditmemo_save_after>
        		</observers>
        	</sales_order_creditmemo_save_after>
        </events>
        <catalog>
        	<product>
        		<type>
        			<giftvoucher translate="label" module="giftvoucher">
        				<label>Gift Voucher</label>
        				<model>giftvoucher/product_type</model>
        				<price_model>giftvoucher/product_price</price_model>
        				<index_data_retreiver>catalogindex/data_simple</index_data_retreiver>
        				<is_qty>1</is_qty>
        			</giftvoucher>
        		</type>
        	</product>
        </catalog>
        <!--template>
        	<email>
        		<giftvoucher_email_self>
        			<label>Send to purchaser</label>
        			<file>giftvoucher/self.html</file>
        			<type>html</type>
        		</giftvoucher_email_self>
        		<giftvoucher_email_template>
        			<label>Send Gift Voucher to friend</label>
        			<file>giftvoucher/gift.html</file>
        			<type>html</type>
        		</giftvoucher_email_template>
        	</email>
        </template-->		
    </global>
    <default>
    	<giftvoucher>
    		<general>
    			<pattern><![CDATA[[N.4]-[AN.4]-[A.4]]]></pattern>
			<cardnopattern><![CDATA[[N.4]-[AN.5]-[A.4]]]></cardnopattern>
			<pincodepattern><![CDATA[[AN.6]]]></pincodepattern>
    			<showprefix>4</showprefix>
    			<hiddenchar>X</hiddenchar>
    			<status>1</status>
    			<autochange>1</autochange>
    			<expire_orderstatus>canceled,closed</expire_orderstatus>
    			<expire>365</expire>
    			<refund_orderstatus>canceled,closed</refund_orderstatus>
    			<maximum>5</maximum>
    		</general>
    		<interface>
    			<amount>25,75,100</amount>
    			<postoffice>1</postoffice>
    			<enable>1</enable>
    			<max>240</max>
    			<preview>0</preview>
    			<display>1</display>
    		</interface>
    		<email>
    			<enable>1</enable>
    			<sender>general</sender>
    			<self>giftvoucher_email_self</self>
    			<template>giftvoucher_email_template</template>
    			<autosend>1</autosend>
    			<daybefore>7</daybefore>
    		</email>
			<print_voucher>
				<logo>default/logo_print.png</logo>
			</print_voucher>
    	</giftvoucher>
    	<payment>
    		<giftvoucher>
    			<active>0</active>
    			<model>giftvoucher/payment_giftvoucher</model>
    			<title>Gift Voucher</title>
    			<order_status>pending</order_status>
    			<invoice>1</invoice>
    			<description><![CDATA[Use your gift voucher that you have to spend for this order!]]></description>
    			<allowspecific>0</allowspecific>
				<sort_order>0</sort_order>
    		</giftvoucher>
    	</payment>
    </default>
   <!-- <crontab>
    	<jobs>
    		<customerreward>
    			<schedule>
    				<cron_expr>0 0 * * *</cron_expr>
    			</schedule>
    			<run>
    				<model>giftvoucher/observer::autoSendMail</model>
    			</run>
    		</customerreward>
    	</jobs>
    </crontab>-->
</config>
